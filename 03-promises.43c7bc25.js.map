{"mappings":"AAQA,MAAMA,EAAS,CACX,cACW,SACL,kBACQ,cACJ,YAGd,IAAIC,EAAc,EAElB,MAAMC,EAAO,CACTC,SAAUC,SAASC,cAAc,gBACjCC,OAAQF,SAASC,cAAc,WAC/BE,SAAUH,SAASC,cAAc,aACjCG,UAAWJ,SAASC,cAAc,6BA8BtC,SAASI,EAAeC,GACpBR,EAAKI,OAAOK,YAAcD,C,CAG9B,SAASE,EAAiBF,GACtBR,EAAKK,SAASI,YAAcD,C,CAhChCR,EAAKC,SAASU,iBAAiB,SAE/B,WACIZ,GAAe,EACf,MAAMa,EAAWd,EAAOe,KAAIC,GAwChC,SAAaA,GACT,OAAO,IAAIC,SAASC,IAChB,MAAMC,GANSC,EAMY,IANPC,EAMa,KAL9BC,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,EAAM,GAAKA,IADxD,IAAuBA,EAAKC,EAQpBI,YAAW,KACPP,EAAQ,C,MAAEF,E,KAAOG,GAAO,GACzBA,EAAK,G,CA9CyBO,CAAIV,KAEzCP,EAAe,IACfG,EAAiB,wCAMMe,EALLb,EAMlBG,QAAQW,KAAKD,GACRE,MAAK,EAACb,MAAEA,EAAKG,KAAEA,MACZV,EAAe,WAACO,qBAAuBG,KAmBnD,UAAwBH,MAAEA,EAAKG,KAAEA,EAAMW,YAAAC,IACnC,MAAMC,EAAK,WAAWD,aAAuBf,aAAiBG,cAC9DjB,EAAKM,UAAUyB,mBAAmB,YAAaD,E,CApBnBE,CAAL,C,MAAElB,E,KAAOG,E,YAAMlB,GAAc,IAIxD,SAAoB0B,GAChBV,QAAQkB,IAAIR,GAASE,MAAK,IACtBjB,EAAiB,uC,CAdrBwB,CAAWtB,GAIf,IAA2Ba,C","sources":["src/js/03-promises.js"],"sourcesContent":["//function createPromise(position, delay) {\n//  const shouldResolve = Math.random() > 0.3;\n//  if (shouldResolve) {\n//    // Fulfill\n//  } else {\n//    // Reject\n//  }\n//}\nconst horses = [\n    'СЕКРИТАРИАТ',\n    'ЭКЛИПС',\n    'ВЕСТ АВСТРАЛИАН',\n    'ФЛАИНГ ФОКС',\n    'СЕБИСКЕТ',\n];\n\nlet raceCounter = 0;\n\nconst refs = {\n    startBtn: document.querySelector('.js-rase-btn'),\n    winner: document.querySelector('.winner'),\n    progress: document.querySelector('.progress'),\n    tableBody: document.querySelector('.js-result-table > tbody'),\n};\n\nrefs.startBtn.addEventListener('click', onStart);\n\nfunction onStart() {\n    raceCounter += 1;\n    const promises = horses.map(horse => run(horse));\n\n    updWinnerField('');\n    updProgressField('Заезд начался, ставки не принимаются');\n    determinateWinner(promises);\n    waitForAll(promises);\n};\n\n\nfunction determinateWinner(horsesP) {\n    Promise.race(horsesP)\n        .then(({ horse, time }) => {\n            updWinnerField(`Победил ${horse}, финишировал за ${time}`)\n            updResultTable({ horse, time, raceCounter })\n        });\n};\n\nfunction waitForAll(horsesP) {\n    Promise.all(horsesP).then(() =>\n        updProgressField('Заезд окончен, принимаются ставки.')\n    );\n};\n\nfunction updWinnerField(message) {\n    refs.winner.textContent = message;\n};\n\nfunction updProgressField(message) {\n    refs.progress.textContent = message;\n};\n\nfunction updResultTable({ horse, time, raceCounter }) {\n    const tr = `<tr><td>${raceCounter}</td><td>${horse}</td><td>${time}</td></tr>`;\n    refs.tableBody.insertAdjacentHTML('beforeend', tr);\n};\n\nfunction getRandomTime(min, max) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nfunction run(horse) {\n    return new Promise((resolve) => {\n        const time = getRandomTime(2000, 3500);\n\n        setTimeout(() => {\n            resolve({ horse, time });\n        }, time);\n    })\n};\n"],"names":["$47d4ff9957288465$var$horses","$47d4ff9957288465$var$raceCounter","$47d4ff9957288465$var$refs","startBtn","document","querySelector","winner","progress","tableBody","$47d4ff9957288465$var$updWinnerField","message","textContent","$47d4ff9957288465$var$updProgressField","addEventListener","promises","map","horse","Promise","resolve","time","min","max","Math","floor","random","setTimeout","$47d4ff9957288465$var$run","horsesP","race","then","raceCounter","raceCounter1","tr","insertAdjacentHTML","$47d4ff9957288465$var$updResultTable","all","$47d4ff9957288465$var$waitForAll"],"version":3,"file":"03-promises.43c7bc25.js.map"}