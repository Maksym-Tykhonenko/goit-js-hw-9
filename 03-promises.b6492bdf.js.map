{"mappings":"YAQA,IAAMA,EAAS,CACX,cACW,SACL,kBACQ,cACJ,YAGVC,EAAc,EAEZC,EAAO,CACTC,SAAUC,SAASC,cAAc,gBACjCC,OAAQF,SAASC,cAAc,WAC/BE,SAAUH,SAASC,cAAc,aACjCG,UAAWJ,SAASC,cAAc,6BA8BtC,SAASI,EAAeC,GACpBR,EAAKI,OAAOK,YAAcD,C,CAG9B,SAASE,EAAiBF,GACtBR,EAAKK,SAASI,YAAcD,C,CAhChCR,EAAKC,SAASU,iBAAiB,SAE/B,WACIZ,GAAe,EACf,IAAMa,EAAWd,EAAOe,KAAI,SAAAC,G,OAwChC,SAAaA,GACT,OAAO,IAAIC,SAAQ,SAACC,GAChB,IANeC,EAAKC,EAMdC,GANSF,EAMY,IANPC,EAMa,KAL9BE,KAAKC,MAAMD,KAAKE,UAAYJ,EAAMD,EAAM,GAAKA,IAOhDM,YAAW,WACPP,EAAQ,CAAEF,QAAOK,Q,GAClBA,E,IA9C8BK,CAAIV,E,IAEzCP,EAAe,IACfG,EAAiB,wCAMMe,EALLb,EAMlBG,QAAQW,KAAKD,GACRE,MAAK,SAAAC,G,IAAGd,EAAKc,EAALd,MAAOK,EAAIS,EAAJT,KACZZ,EAAe,WAA2CsB,OAAzBf,EAAM,qBAAqCe,OAALV,IAmBnF,SAAwBS,G,IAAEd,EAAFc,EAAEd,MAAOK,EAATS,EAAST,KAAMW,EAAfF,EAAeG,YAC7BC,EAAK,WAAkCH,OAAvBC,EAAY,aAA4BD,OAAjBf,EAAM,aAAgBe,OAALV,EAAK,cACnEnB,EAAKM,UAAU2B,mBAAmB,YAAaD,E,CApBnBE,CAAL,CAAEpB,QAAOK,OAAMY,YAAAhC,G,IAI1C,SAAoB0B,GAChBV,QAAQoB,IAAIV,GAASE,MAAK,W,OACtBjB,EAAiB,qC,IAdrB0B,CAAWxB,GAIf,IAA2Ba,C","sources":["src/js/03-promises.js"],"sourcesContent":["//function createPromise(position, delay) {\n//  const shouldResolve = Math.random() > 0.3;\n//  if (shouldResolve) {\n//    // Fulfill\n//  } else {\n//    // Reject\n//  }\n//}\nconst horses = [\n    'СЕКРИТАРИАТ',\n    'ЭКЛИПС',\n    'ВЕСТ АВСТРАЛИАН',\n    'ФЛАИНГ ФОКС',\n    'СЕБИСКЕТ',\n];\n\nlet raceCounter = 0;\n\nconst refs = {\n    startBtn: document.querySelector('.js-rase-btn'),\n    winner: document.querySelector('.winner'),\n    progress: document.querySelector('.progress'),\n    tableBody: document.querySelector('.js-result-table > tbody'),\n};\n\nrefs.startBtn.addEventListener('click', onStart);\n\nfunction onStart() {\n    raceCounter += 1;\n    const promises = horses.map(horse => run(horse));\n\n    updWinnerField('');\n    updProgressField('Заезд начался, ставки не принимаются');\n    determinateWinner(promises);\n    waitForAll(promises);\n};\n\n\nfunction determinateWinner(horsesP) {\n    Promise.race(horsesP)\n        .then(({ horse, time }) => {\n            updWinnerField(`Победил ${horse}, финишировал за ${time}`)\n            updResultTable({ horse, time, raceCounter })\n        });\n};\n\nfunction waitForAll(horsesP) {\n    Promise.all(horsesP).then(() =>\n        updProgressField('Заезд окончен, принимаются ставки.')\n    );\n};\n\nfunction updWinnerField(message) {\n    refs.winner.textContent = message;\n};\n\nfunction updProgressField(message) {\n    refs.progress.textContent = message;\n};\n\nfunction updResultTable({ horse, time, raceCounter }) {\n    const tr = `<tr><td>${raceCounter}</td><td>${horse}</td><td>${time}</td></tr>`;\n    refs.tableBody.insertAdjacentHTML('beforeend', tr);\n};\n\nfunction getRandomTime(min, max) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n};\n\nfunction run(horse) {\n    return new Promise((resolve) => {\n        const time = getRandomTime(2000, 3500);\n\n        setTimeout(() => {\n            resolve({ horse, time });\n        }, time);\n    })\n};\n"],"names":["$ce04d3a99e08e73b$var$horses","$ce04d3a99e08e73b$var$raceCounter","$ce04d3a99e08e73b$var$refs","startBtn","document","querySelector","winner","progress","tableBody","$ce04d3a99e08e73b$var$updWinnerField","message","textContent","$ce04d3a99e08e73b$var$updProgressField","addEventListener","promises","map","horse","Promise","resolve","min","max","time","Math","floor","random","setTimeout","$ce04d3a99e08e73b$var$run","horsesP","race","then","param","concat","raceCounter1","raceCounter","tr","insertAdjacentHTML","$ce04d3a99e08e73b$var$updResultTable","all","$ce04d3a99e08e73b$var$waitForAll"],"version":3,"file":"03-promises.b6492bdf.js.map"}